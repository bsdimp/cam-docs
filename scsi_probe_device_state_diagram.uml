@startuml

Title SCSI Probe Device State Diagram

[*] --> probeschedule
probeschedule: :CAM_DEV_UNCONFIGURED [1]
probeschedule: :default [2]

probeschedule --> PROBE_TUR : [1]
probeschedule --> PROBE_INQUIRY : [2]

PROBE_INQUIRY : Inquire
PROBE_FULL_INQUIRY : Full Inquiry
PROBE_REPORT_LUNS : Report LUNs
PROBE_MODE_SENSE : Mode Sense
PROBE_VPD_LIST : VPD List
PROBE_DEVICE_ID : Device ID
PROBE_EXT_INQUIRY : Ext Inquiry
PROBE_TUR_FOR_NEG : TUR for NEG
PROBE_SERIAL_NUM : Serial Num
PROBE_INQ_DV2 : INQ DV1
PROBE_INQ_DV1 : INQ DV2
PROBE_DV_EXIT : DV Exit
PROBE_DONE : Done
PROBE_INVALID : Invalid

PROBE_TUR -> PROBE_INQUIRY : TUR
PROBE_INQUIRY -> PROBE_FULL_INQUIRY : More INQ
PROBE_INQUIRY -> PROBE_REPORT_LUNS : has LUNs
PROBE_INQUIRY -> PROBE_MODE_SENSE : TQ Enabled
PROBE_INQUIRY -> PROBE_VPD_LIST
PROBE_INQUIRY -> PROBE_INVALID : INQ Invalid
PROBE_FULL_INQUIRY -> PROBE_REPORT_LUNS : has LUNs
PROBE_FULL_INQUIRY -> PROBE_MODE_SENSE : TQ Enabled
PROBE_FULL_INQUIRY -> PROBE_VPD_LIST
PROBE_FULL_INQUIRY -> PROBE_INVALID : INQ Invalid
PROBE_REPORT_LUNS -> PROBE_MODE_SENSE : TQ Enabled
PROBE_REPORT_LUNS -> PROBE_VPD_LIST
PROBE_REPORT_LUNS -> PROBE_INVALID : LUNs Bad
PROBE_MODE_SENSE -> PROBE_VPD_LIST : Mode Sense
PROBE_VPD_LIST -> PROBE_DEVICE_ID : VPD
PROBE_DEVICE_ID -> PROBE_EXT_INQUIRY : Device ID
PROBE_EXT_INQUIRY -> PROBE_SERIAL_NUM : Serial Num
PROBE_SERIAL_NUM -> PROBE_TUR_FOR_NEG : TUR
PROBE_TUR_FOR_NEG -> PROBE_INQ_DV1
PROBE_INQ_DV1 -> PROBE_INQ_DV2 : good INQ
PROBE_INQ_DV1 -> PROBE_DV_EXIT : failure
PROBE_INQ_DV2 -> PROBE_DV_EXIT : failure
PROBE_INQ_DV2 -> PROBE_DONE : good INQ
PROBE_DV_EXIT -> PROBE_INQUIRY : TUR
PROBE_DV_EXIT -> PROBE_DONE
PROBE_INVALID -> PROBE_TUR : LUN = 0
PROBE_INVALID -> PROBE_INQUIRY : LUN != 0
@enduml
